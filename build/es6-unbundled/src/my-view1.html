<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/paper-input/paper-input.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="../bower_components/paper-spinner/paper-spinner.html"><link rel="import" href="../bower_components/iron-list/iron-list.html"><link rel="import" href="../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="shared-styles.html"></head><body><dom-module id="my-view1"><template><style include="shared-styles">:host{display:block;padding:10px;}.item{padding:10px;border-bottom:1px solid #ccc;background:white;}.item:hover{opacity:0.7;cursor:pointer;}.loadingIndicator{text-align:center;height:40px;}paper-spinner{width:20px;height:20px;margin-right:10px;}</style><iron-ajax auto="" url="{{url}}" params="{}" handle-as="json" on-response="_commentsLoaded" loading="{{loadingData}}" debounce-duration="300"></iron-ajax><div style="background: white; padding: 26px;"><paper-input readonly="" value="{{id}}" label="ID" always-float-label=""></paper-input><paper-input value="{{author}}" label="Author" always-float-label=""></paper-input><paper-input value="{{text}}" label="Message" always-float-label=""></paper-input><paper-button on-tap="_addOrUpdate" style="background: green; color: white;">Submit</paper-button><paper-button on-tap="_clear" style="background: gray; color: white;">Clear</paper-button><paper-button on-tap="_delete" style="background: red; color: white; float: right;">Delete</paper-button></div><br><iron-list items="[[comments]]" selection-enabled="" as="item" scroll-target="threshold"><template><div class="item"><div id="[[item._id]]~[[item.author]]~[[item.text]]" on-tap="_select"><div id="[[item._id]]~[[item.author]]~[[item.text]]" style="font-size:12px; color:gray">[[item._id]]</div><div id="[[item._id]]~[[item.author]]~[[item.text]]"><span id="[[item._id]]~[[item.author]]~[[item.text]]" style="font-size:12px; color:gray">AUTHOR:</span> [[item.author]]</div><div id="[[item._id]]~[[item.author]]~[[item.text]]"><span id="[[item._id]]~[[item.author]]~[[item.text]]" style="font-size:12px; color:gray">Message:</span> [[item.text]]</div></div></div></template></iron-list><div class="loadingIndicator"><paper-spinner active="{{loadingData}}"></paper-spinner></div><iron-scroll-threshold id="threshold" lower-threshold="500" on-lower-threshold="loadMoreData"></iron-scroll-threshold><iron-ajax verbose="" id="ajax" method="[[method]]" on-response="_handleResponse"></iron-ajax></template><script>class MyView1 extends Polymer.Element{static get is(){return"my-view1"}static get properties(){return{baseUrl:String}}ready(){super.ready();this.url="/comment/read"}loadMoreData(){this.$.threshold.clearTriggers()}_commentsLoaded(data){if(null!==data.detail.response.data){this.comments=data.detail.response.data}}_handleResponse(){this.url="/comment/read";this.id="";this.author="";this.text="";this.method=""}_addOrUpdate(){if(this.author&&this.text){if(this.id){this.method="PUT";this.$.ajax.url="/comment/edit/"+this.id;this.$.ajax.contentType="application/json";this.$.ajax.body={author:this.author,text:this.text};this.$.ajax.generateRequest();alert("OK");this.url=""}else{for(var i=0;5e3>i;i++){this.method="POST";this.$.ajax.url="/comment/add";this.$.ajax.contentType="application/json";this.$.ajax.body={author:this.author+[i],text:this.text+[i]};this.$.ajax.generateRequest()}alert("OK");this.url=""}}}_delete(){if(this.id){this.method="DELETE";this.$.ajax.url="/comment/delete/"+this.id;this.$.ajax.generateRequest();alert("OK");this.url=""}}_clear(){this.id="";this.author="";this.text=""}_select(e){var data_args=Polymer.dom(e).rootTarget.getAttribute("id"),[id,author,text]=data_args.split("~");this.id=id;this.author=author;this.text=text}}window.customElements.define(MyView1.is,MyView1);</script></dom-module></body></html>