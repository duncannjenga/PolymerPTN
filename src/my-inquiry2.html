<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/iron-list/iron-list.html">
<link rel="import" href="../bower_components/iron-scroll-threshold/iron-scroll-threshold.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/vaadin-dialog/vaadin-dialog.html">
<link rel="import" href="../bower_components/salte-dialog/salte-dialog.html">
<link rel="import" href="../bower_components/paper-dropdown-input/paper-dropdown-input.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">


<link rel="import" href="time-element.html">
<link rel="import" href="shared-styles.html">
<dom-module id="my-inquiry2">
    <template>
        <style include="shared-styles">
            :host {
                height: 100vh;
                margin: 0;
                display: flex;
                flex-direction: column;
            }

            #table {
                opacity: 1;
                animation-name: fadeInOpacity;
                animation-iteration-count: 1;
                animation-timing-function: ease-in;
                animation-duration: 0.5s;
            }

            @keyframes fadeInOpacity {
                0% {
                    opacity: 0;
                }
                100% {
                    opacity: 1;
                }
            }

            @media (max-width: 768px) {
                div .availability {
                    margin: 16px;
                    display: flex;
                    flex-direction: column;
                    border-radius: 3px;
                }
                #dateandRoom {
                    display: flex;
                }
            }

            @media (min-width: 768px) {
                div .availability {
                    width: 765px;
                    margin: 16px auto;
                    border-radius: 3px;

                    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
                }
            }

            #hotels {
                font-size: small;
                /* font-family: "Trebuchet MS", Arial, Helvetica, sans-serif; */
                border-collapse: collapse;
                width: 100%;
            }

            #hotels td,
            #hotels th {
                text-align: center;
                border: 1px solid #ddd;
                /* padding: 2px; */
            }

            #hotels th {
                padding-top: 12px;
                padding-bottom: 12px;
            }

            .avatar-container-profile {
                position: relative;
                border: 2px solid darkorange;
                border-radius: 50%;
                height: 90px;
                padding: 2px;
                width: 90px;
                margin: 20px auto;
            }

            app-header {
                color: rgb(255, 255, 255);
                background-color: darkorange;
            }

            hr {
                background-color: #eee;
                border: 0 none;
                color: #eee;
                height: 1px;
            }
        </style>
        <!-- group -->
        <iron-ajax auto url="{{urlGroup}}" handle-as="json" method="GET" on-response="_groupLoaded"></iron-ajax>
        <iron-ajax auto url="{{urluser}}" handle-as="json" method="GET" on-response="_userLoaded"></iron-ajax>
        <!-- <iron-ajax auto url="{{urlJoin}}" params='{}' handle-as="json" method="GET" on-response="_joinLoaded" loading="{{loadingData}}" debounce-duration="300"></iron-ajax> -->
        <!-- allocation -->
        <iron-ajax id="workspace" url="{{urlFilterworkspace}}" handle-as="json" method="GET" on-response="_urlFilterworkspaceloaded"></iron-ajax>
        <!-- <iron-ajax id="startalloc" url="{{urlFilterStart}}" handle-as="json" method="GET" on-response="_urlFilterStartloaded"></iron-ajax> -->
        <iron-ajax id="endalloc" url="{{urlFilterend}}" handle-as="json" method="GET" on-response="_urlFilterend"></iron-ajax>
        <!-- availability -->
        <!-- <iron-ajax id="startavail" url="{{Startavail}}" handle-as="json" method="GET" on-response="_startavailloaded"></iron-ajax> -->
        <iron-ajax id="endavail" url="{{Endavail}}" handle-as="json" method="GET" on-response="_endavailloaded"></iron-ajax>
        <!-- blockings -->
        <!-- <iron-ajax id="startblock" url="{{Startblockings}}" handle-as="json" method="GET" on-response="_startblockloaded"></iron-ajax> -->
        <iron-ajax id="endblock" url="{{Endblockings}}" handle-as="json" method="GET" on-response="_endblockloaded"></iron-ajax>
        <iron-pages selected="[[route.path]]" attr-for-selected="name" fallback-selection="view404" role="main">
            <div name="">
                <app-header-layout fullbleed has-scrolling-region>
                    <app-header fixed slot="header">
                        <app-toolbar>
                            <paper-icon-button class="menu" icon="my-icons:menu" drawer-toggle on-tap="toggleDrawer"></paper-icon-button>
                            <div main-title>Agent Inquiry</div>
                        </app-toolbar>
                    </app-header>
                    <div class="card">
                        <div style="display: inline;" id="dateandRoom">
                            <div style="display: flex">
                                <div style="display: flex">
                                    <template is="dom-if" if="{{checkRole(role)}}">
                                        <paper-dropdown-input label="Select Group" items='[[groupItems]]' filter-property="group" value="{{group}}">
                                            <template>
                                                <template is="dom-repeat" items="[[items]]" as="item">
                                                    <paper-item>[[item.group]]</paper-item>
                                                </template>
                                            </template>
                                        </paper-dropdown-input>
                                    </template>
                                    <div style="display: flex; margin-left: 20px;">
                                        <paper-input label="Check in" type="date" value="{{checkin}}">
                                            <iron-icon icon="my-icons:date-range" slot="prefix"></iron-icon>
                                        </paper-input>
                                    </div>
                                    <div style="display: flex; margin-left: 20px;">
                                        <paper-input label="Check out" type="date" value="{{checkout}}">
                                            <iron-icon icon="my-icons:date-range" slot="prefix"></iron-icon>
                                        </paper-input>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div id="peak">
                            <span style="color: red">Peak Season</span>
                            <span style="color: green;margin-left: 14px;">Open</span>
                            <!-- <span style="color:yellow;margin-left: 14px;">limited</span> -->
                        </div>
                        <div id="table">
                            <span style="float: right">{{start}} {{end}}</span>
                            <div id="errorMsgDiv" style="display: none;">
                                <iron-icon icon="my-icons:error-outline"></iron-icon>&nbsp;{{errorMsg}}</div>
                            <table id="hotels">
                            </table>
                        </div>
                    </div>
                </app-header-layout>
        </iron-pages>
        <paper-dialog id="moreDetails">
            <h2>Details</h2>
            <div>Rooms:{{rooms}}
                <div>Status: {{status}}</div>
            </div>
            <div>
                <b>Allocation</b>
                <div>Non-peak: {{nonpeak}}</div>
                <div>Peak: {{peak}}</div>
                <div>Cut-off peak: {{pdays}} days</div>
                <div>Cut-off non-peak: {{nonpdays}} days</div>
                <div>
                    <b>Peak Seasons:</b>
                    <template is="dom-repeat" items="[[seasondates]]">
                        <div>
                            <b>Start: </b> {{item.startValue}}</div>
                        <div>
                            <b>End: </b> {{item.endValue}}</div>
                    </template>
                </div>
                <div>Blocking: {{blocking}}</div>
                <div>Cancellation: {{cancel}}</div>
            </div>
            <div class="buttons">
                <paper-button dialog-dismiss>Ok</paper-button>
            </div>
        </paper-dialog>
    </template>

    <script>
        Polymer({
            is: 'my-inquiry2',
            properties: {
                checkin: String,
                checkout: String,
                stardate: String,
                enddate: String,
                group: String,
                agent: String,
                groupworkspace: Object,
                startload: Object,
                endload: Object,
                startavail: Object,
                endavail: Object,
                endblock: Object,
                startblock: Object,
                roomSelected: String,
                hotelAvavil: String,
                hotelAlloc: String,
                hotelBlock: String,
                accountKey: String,
                role: String,
                newBlock: {
                    type: Array,
                    notify: true
                },
                newAlloc: {
                    type: Array,
                    notify: true
                },
                joinedblock: {
                    type: Array,
                    notify: true
                },
                joinedalloc: {
                    type: Array,
                    notify: true
                },
                joinedavail: {
                    type: Array,
                    notify: true
                },
                filterBlock: {
                    type: Array,
                    notify: true
                },
                filterAlloc: {
                    type: Array,
                    notify: true,
                },
                from: String,
                to: String,
                concatAll: String,

                tr3: String,
                eleAvail: String,
                eleHotel: {
                    type: Array,
                    value: [],
                    notify: true,
                },
                eleRoom: {
                    type: Array,
                    value: [],
                    notify: true,
                },
                pushHotel: {
                    type: Array,
                    value: [],
                },
                pushRooms: {
                    type: Array,
                    value: [],
                    notify: true
                },
                newArray: {
                    type: Array,
                    value: [],
                    notify: true
                },
                newHotel: {
                    type: Array,
                    value: [],
                    notify: true
                },
                status: String
            },
            observers: ['_startCheckin(checkin)',
                '_endCheckout(checkout)',
                '_hotelIdChanged(group)',
                // '_joinedAvail(startavail,endavail)',
                // '_joinedAlloc(groupworkspace,startload,endload)',
                // '_joinedBlock(groupworkspace,startblock,endblock)',
                // '_unionAll(joinedavail,filterAlloc,filterBlock)',
                // '_tappedChanged(tapped)'
            ],
            ready() {
                this.urlGroup = 'group/read';
                this.urluser = '/user/getkey/' + this.accountKey;
                var hidePeak = Polymer.dom(this.root).querySelector("#peak").setAttribute("style", "display:none");
                var errormsg = Polymer.dom(this.root).querySelector("#errorMsgDiv").setAttribute("style", "display:none");
                this.errorMsg = "";
                var table = Polymer.dom(this.root).querySelector('#hotels');
                while (table.hasChildNodes()) {
                    table.removeChild(table.lastChild);
                }
                this.start = "";
                this.end = "";
            },
            _userLoaded(data) {
                this.group = data.detail.response.data.group;
                this.agent = data.detail.response.data.agent;
                this.role = data.detail.response.data.role;
            },
            checkRole(c) {
                if (c === "Admin Staff" || c === "Staff") return true;
                else { }
            },
            // _tappedChanged(e) {
            //     var [rooms, stat, nonpeak, peak, seasondates, blocking, cancel, pdays, nonpdays] = e.split("~");
            //     this.rooms = rooms;
            //     this.status = stat;
            //     this.nonpeak = nonpeak;
            //     this.peak = peak;
            //     this.seasondates = JSON.parse(seasondates);
            //     this.blocking = blocking;
            //     this.cancel = cancel;
            //     this.pdays = pdays;
            //     this.nonpdays = nonpdays;
            //     this.$.moreDetails.opened = true;
            // },
            _hotelIdChanged(j) {
                this.stardate = this.checkin;
                this.roomSelected = j;
                this.urlFilterworkspace = '/group/filter/' + j;
                this.$.workspace.handleAs = "json";
                this.$.workspace.generateRequest();
            },
            _urlFilterworkspaceloaded(data) {
                this.groupworkspace = data.detail.response.data;
            },
            _startCheckin(e) {
                this.from = e;
                // this.urlFilterStart = '/allocation/filterstartdate/' + e + "_" + this.to;
                // this.Startavail = '/availability/filterstartdate/' + e + "_" + this.to;
                // this.Startblockings = '/blocking/filterstartdate/' + e + "_" + this.to;
                // this.$.startalloc.generateRequest();
                // this.$.startavail.generateRequest();
                // this.$.startblock.generateRequest();
            },
            // _urlFilterStartloaded(data) {
            //     if (data.detail.response.data) {
            //         if (this.endload) {
            //             this.startload = data.detail.response.data;
            //         }
            //     }
            // },
            // _startavailloaded(data) {
            //     if (data.detail.response.data) {
            //         if (this.endavail) {
            //             this.startavail = data.detail.response.data;
            //         }
            //     }
            // },
            // _startblockloaded(data) {
            //     if (data.detail.response.data) {
            //         if (this.endblock) {
            //             this.startblock = data.detail.response.data;
            //         }
            //     }
            // },
            _endCheckout(f) {
                this.to = f;
                if (this.role === "Admin Staff" || this.role === "Staff") {
                    this.urlFilterend = '/allocation/inquirySource2/' + this.from + "_" + this.to + "_" + this.group + "_" + this.group;
                    this.$.endalloc.generateRequest();
                }
                else {
                    this.urlFilterend = '/allocation/inquirySource2/' + this.from + "_" + this.to + "_" + this.group + "_" + this.agent;
                    this.$.endalloc.generateRequest();
                }
                // if (this.to && this.from && this.roomSelected) {
                // if(){}

                // this.Endavail = '/availability/filterenddate/' + f + "_" + this.from;
                // this.Endblockings = '/blocking/filterenddate/' + f + "_" + this.from;

                // this.$.endavail.generateRequest();
                // this.$.endblock.generateRequest();
                // }
            },
            // _endavailloaded(data) {
            //     if (data.detail.response.data) {
            //         this.endavail = data.detail.response.data;
            //     }
            // },
            _urlFilterend(data) {
                if (data.detail.response.data) {
                    // var _dateFrom = new Date(this.from);
                    // var _dateTo = new Date(this.to);
                    // var one_day = 1000 * 60 * 60 * 24;
                    // var difference_ms = _dateTo.getTime() - _dateFrom.getTime();
                    // var _numOfDays = Math.round(difference_ms / one_day);
                    // var _currentDate = new Date(_dateFrom);
                    // console.log(_currentDate.getFullYear() + " " + _currentDate.getMonth() + " " + _currentDate.getDate());
                    // var _currentDate_format = _currentDate.getFullYear() + "-" + ("0" + (_currentDate.getMonth() + 1)).slice(-2) + "-" + ("0" + _currentDate.getDate()).slice(-2)
                    // console.log(_currentDate_format);
                    // for (var i = 1; i < (_numOfDays + 2); i++) {
                    //     _currentDate.setDate(i);
                    //     var _currentDate_format = _currentDate.getFullYear() + "-" + ("0" + _currentDate.getMonth()).slice(-2) + "-" + ("0" + _currentDate.getDate()).slice(-2)
                    // console.log(_currentDate_format);
                    // this.endload = data.detail.response.data;
                    // console.log(this.endload);
                    var _urlresponse = data.detail.response.data;
                    console.log(_urlresponse);
                    // var _tofinalResult = [];
                    // _urlresponse.forEach(_availArray => {
                    //     var _returnData = {};
                    //     _returnData.hotel = _availArray.hotel;
                    //     this.hotelAvavil = _returnData.hotel;
                    //     if (_availArray.status === "undefined") { }
                    //     else if (_availArray.status) {
                    //         if (_availArray.status.length > 0) {
                    //             _availArray.status.forEach(_statusperDate => {
                    //                 if (_statusperDate) {
                    //                     if (_statusperDate.date == _currentDate_format) {
                    //                         _returnData.date = _currentDate_format;
                    //                         _returnData.room = _statusperDate.roomname;
                    //                         _returnData.statusColor = _statusperDate.classColor;
                    //                         _returnData.status = _statusperDate.status;
                    //                         _tofinalResult.push(_returnData);
                    //                     }
                    //                 }
                    //             });
                    //         }
                    //     }
                    // });
                    // _urlresponse.forEach(_allocArray => {
                    //     if (_allocArray.hotel == this.hotelAvavil) {


                    //     }
                    // });


                    // console.log(_tofinalResult);

                    // }
                }
            },
            // _endblockloaded(data) {
            //     if (data.detail.response.data) {
            //         this.endblock = data.detail.response.data;
            //     }
            // },
            // _joinedAlloc(x, a, b) {
            //     if (this.groupworkspace && this.startload && this.endload) {
            //         this.joinedalloc = this.startload.concat(this.endload);
            //         this.newAlloc = this.joinedalloc.filter((allocarray) => {
            //             return this.groupworkspace.some((grouparray) => {
            //                 return grouparray.group === allocarray.group;
            //             });
            //         });
            //         var sameId = this.newAlloc;
            //         function printUniqueResults(arrayOfdatas, id) {
            //             return arrayOfdatas.filter((item, index, array) => {
            //                 return array.map((mapItem) => mapItem[id]).indexOf(item[id]) === index
            //             })
            //         }
            //         var result = printUniqueResults(sameId, '_id');
            //         this.filterAlloc = result;
            //     }
            // },
            // _joinedAvail(f, g) {
            //     if (this.startavail && this.endavail) {
            //         this.joinedavail = this.startavail.concat(this.endavail);

            //     }
            // },
            // _joinedBlock(x, y, z) {
            //     if (this.groupworkspace && this.startblock && this.endblock) {
            //         this.joinedblock = this.startblock.concat(this.endblock);
            //         this.newBlock = this.joinedblock.filter((allocarray) => {
            //             return this.groupworkspace.some((grouparray) => {
            //                 return grouparray.group === allocarray.group;
            //             });
            //         });
            //         var sameId = this.newBlock;
            //         function printUniqueResults(arrayOfdatas, id) {
            //             return arrayOfdatas.filter((item, index, array) => {
            //                 return array.map((mapItem) => mapItem[id]).indexOf(item[id]) === index
            //             })
            //         }
            //         var filterresult = printUniqueResults(sameId, '_id')
            //         this.filterBlock = filterresult;
            //     }
            // },
            // _unionAll(k, l, m) {
            //     if (this.checkin == "" || this.checkout == "") {
            //         var table = Polymer.dom(this.root).querySelector('#hotels');
            //         while (table.hasChildNodes()) {
            //             table.removeChild(table.lastChild);
            //         }
            //         this.start = "";
            //         this.end = "";
            //         var errormsg = Polymer.dom(this.root).querySelector("#errorMsgDiv");
            //         errormsg.setAttribute("style", "font-size:12px; display: block; background-color:red; color:white; text-align:center; border-radius: 5px; opacity:0.5; padding:5px");
            //         this.errorMsg = "Select Chekin or Checkout";
            //     }
            //     else {
            //         var errormsg = Polymer.dom(this.root).querySelector("#errorMsgDiv").setAttribute("style", "display:none");
            //         this.errorMsg = "";
            //         if (this.filterAlloc && this.filterBlock) {
            //             var initialArray = [];
            //             this.filterAlloc.forEach(elAllo => {
            //                 this.joinedavail.forEach(elAvail => {
            //                     if (elAllo.hotel === elAvail.hotel) {
            //                         elAvail.availability.forEach(minElAvail => {
            //                             elAllo.rooms.forEach(roomele => {
            //                                 if (minElAvail.room === roomele.room.split(" ").join("")) {
            //                                     roomele.availability = {
            //                                         status: minElAvail.status,
            //                                         data: minElAvail.date
            //                                     };
            //                                     roomele.status = minElAvail.status;
            //                                 }
            //                             });
            //                         });
            //                         elAllo.avail = elAvail;
            //                     }
            //                     this.filterBlock.forEach(elBlock => {
            //                         if (elAllo.hotel === elBlock.hotel) {
            //                             elBlock.rooms.forEach(minElBlock => {
            //                                 elAllo.rooms.forEach(roomeleB => {
            //                                     if (minElBlock.room === roomeleB.room.split(" ").join("")) {
            //                                         roomeleB.blocking = {
            //                                             start: minElBlock.dateFrom,
            //                                             end: minElBlock.dateTo,
            //                                             cancel: minElBlock.cancel,
            //                                             block: parseInt(minElBlock.block),
            //                                             total: parseInt(minElBlock.block) + parseInt(roomeleB.peak) + parseInt(roomeleB.nonpeak)
            //                                         };
            //                                     }
            //                                 });
            //                             });
            //                             elAllo.blocking = elBlock;
            //                         }
            //                     });
            //                 });
            //                 initialArray.push(elAllo);
            //             });
            //             function printUniqueResults(arrayOfdatas, hotel) {
            //                 return arrayOfdatas.filter((item, index, array) => {
            //                     return array.map((mapItem) => mapItem[hotel]).indexOf(item[hotel]) === index
            //                 })
            //             }
            //             var finalArray = printUniqueResults(initialArray, 'hotel');
            //             // if (finalArray.length > 0) {
            //             var array = [];
            //             var array1 = [];
            //             var array2 = [];
            //             var array3 = [];
            //             finalArray.forEach(elements => {
            //                 if (elements) {
            //                     array.push(elements.hotel);
            //                     array1.push(elements.rooms);
            //                     array2.push(elements.seasondate);
            //                     if (elements.avail) {
            //                     }
            //                 }
            //             });
            //             var start = new Date(this.from);
            //             var stardate = start.getDate();
            //             var startmonth = start.getMonth();
            //             var startMonth = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();
            //             var end = new Date(this.to);
            //             var enddate = end.getDate();
            //             var endmonth = end.getMonth();
            //             var endMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0).getDate();
            //             this._createTable(finalArray, stardate, startMonth, enddate);
            //             this.start = this._selectMonth(startmonth) + " " + stardate + " - ";
            //             this.end = this._selectMonth(endmonth) + " " + enddate;
            //             if (finalArray.length > 0) {
            //                 if (stardate && enddate) {
            //                     this.start = this._selectMonth(startmonth) + " " + stardate + " - ";
            //                     this.end = this._selectMonth(endmonth) + " " + enddate;
            //                 }
            //                 var errormsg = Polymer.dom(this.root).querySelector("#errorMsgDiv").setAttribute("style", "display:none");
            //                 this.errorMsg = "";
            //                 this._createTable(finalArray, stardate, startMonth, enddate);

            //             } else {
            //                 var errormsg = Polymer.dom(this.root).querySelector("#errorMsgDiv");
            //                 errormsg.setAttribute("style", "font-size:12px; display: block; background-color:red; color:white; text-align:center; border-radius: 5px; opacity:0.5; padding:5px");
            //                 this.errorMsg = "No data Available";

            //                 var table = Polymer.dom(this.root).querySelector('#hotels');
            //                 while (table.hasChildNodes()) {
            //                     table.removeChild(table.lastChild);
            //                 }
            //                 this.start = "";
            //                 this.end = "";
            //             }
            //         }
            //         // }

            //     }
            // },
            // _createTable(data, datestart, startmonth, dateEnd) {
            //     // console.log(data);
            //     var table = Polymer.dom(this.root).querySelector('#hotels');
            //     while (table.hasChildNodes()) {
            //         table.removeChild(table.lastChild);
            //     }
            //     var tr1 = document.createElement('tr');
            //     var th2 = document.createElement('td');
            //     var t1 = document.createTextNode("Hotel");
            //     var th1 = document.createElement('td');
            //     var t2 = document.createTextNode("Rooms");
            //     var tr2 = document.createElement('tr');
            //     var t3 = document.createElement('td');
            //     var td1 = document.createTextNode("");
            //     var t4 = document.createElement('td');
            //     var td2 = document.createTextNode("Cut-off");
            //     th1.append(t1);
            //     th2.append(t2);
            //     t3.append(td1);
            //     t4.append(td2);
            //     tr1.append(th1);
            //     tr1.append(th2);
            //     tr2.append(t3);
            //     tr2.append(t4);
            //     table.append(tr1);
            //     table.append(tr2);

            //     var [year, month, date] = this.from.split("-");
            //     var [yearend, monthend, dateend] = this.to.split("-");

            //     data.forEach(newData => {
            //         newData.rooms.forEach(eles => {
            //             var tr3 = document.createElement('tr');
            //             var th3 = document.createElement('td');
            //             var th4 = document.createElement('td');
            //             var tdTxt = document.createTextNode(newData.hotel);
            //             var tdTxt1 = document.createTextNode(eles.room);
            //             // tr3.setAttribute('id', newData.hotel);
            //             // tr3.setAttribute('id', eles.room);
            //             th3.append(tdTxt);
            //             tr3.append(th3);
            //             th4.append(tdTxt1);
            //             tr3.append(th4);
            //             table.append(tr3);
            //             // if (newData.avail) {
            //             //     newData.avail.forEach(same => {
            //             //         this.status = same.status;
            //             //     });
            //             // }

            //             if (monthend == month) {
            //                 for (i = datestart; i < dateEnd + 1; ++i) {
            //                     var tdblanks2 = document.createElement('td');
            //                     var cutoffblanks = document.createElement('td');
            //                     var cal = parseInt(eles.nonpeak) + parseInt(eles.peak);
            //                     var seasondates = JSON.stringify(newData.seasondate);
            //                     tr2.append(t3);
            //                     tr2.append(t4);
            //                     // console.log(tdblanks2);
            //                     if (newData.avail) {
            //                         if (eles.availability) {
            //                             if (eles.availability.status === "closed") {
            //                                 var [y, m, d] = eles.availability.data.split("-");
            //                                 if (parseInt(d) === i) {
            //                                     var dTxt = document.createTextNode(eles.availability.status);
            //                                     tdblanks2.append(dTxt);
            //                                 } else {
            //                                     var dTxt = document.createTextNode(cal);
            //                                     tdblanks2.append(dTxt);
            //                                     tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + "0" + "~" + "none" + "~" + eles.pdays + "~" + eles.nonpdays);
            //                                     var self = this;
            //                                     tdblanks2.addEventListener('click', function (e) {
            //                                         self.tapped = e.target.id;
            //                                     });
            //                                 }
            //                             }
            //                             else {
            //                                 if (newData.blocking) {
            //                                     if (eles.blocking) {
            //                                         var [ybs, mbs, dbs] = eles.blocking.start.split("-");
            //                                         var [ybe, mbe, dbe] = eles.blocking.end.split("-");
            //                                         if (i >= parseInt(dbs) && i <= parseInt(dbe)) {
            //                                             var dTxt = document.createTextNode(eles.blocking.total);
            //                                             tdblanks2.append(dTxt);
            //                                             tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + eles.blocking.block + "~" + eles.blocking.cancel + "~" + eles.pdays + "~" + eles.nonpdays);
            //                                         }
            //                                         else {
            //                                             var dTxt = document.createTextNode(cal);
            //                                             tdblanks2.append(dTxt);
            //                                             tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + "0" + "~" + "none" + "~" + eles.pdays + "~" + eles.nonpdays);
            //                                         }
            //                                     }
            //                                     else {
            //                                         var dTxt = document.createTextNode(cal);
            //                                         tdblanks2.append(dTxt);
            //                                         tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + "0" + "~" + "none" + "~" + eles.pdays + "~" + eles.nonpdays);
            //                                     }
            //                                 }
            //                                 else {
            //                                     var dTxt = document.createTextNode(cal);
            //                                     tdblanks2.append(dTxt);
            //                                     tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + "0" + "~" + "none" + "~" + eles.pdays + "~" + eles.nonpdays);

            //                                 }
            //                                 var self = this;
            //                                 tdblanks2.addEventListener('click', function (e) {
            //                                     self.tapped = e.target.id;


            //                                 });
            //                             }
            //                         }
            //                     }
            //                     else {
            //                         var dTxt = document.createTextNode(cal);
            //                         tdblanks2.append(dTxt);
            //                         tdblanks2.setAttribute('id', eles.room + "~" + "no update" + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + "0" + "~" + "none" + "~" + eles.pdays + "~" + eles.nonpdays);
            //                         var self = this;
            //                         tdblanks2.addEventListener('click', function (e) {
            //                             self.tapped = e.target.id;

            //                         });
            //                     }
            //                     tr3.append(tdblanks2);
            //                 }
            //             } else {
            //                 for (i = datestart; i < startmonth + 1; ++i) {
            //                     var tdblanks2 = document.createElement('td');
            //                     tdblanks2.setAttribute('id', eles.availability.status + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + eles.blocking.block + "~" + eles.blocking.cancel + "~" + eles.pdays + "~" + eles.nonpdays);
            //                     tr3.append(tdblanks2);
            //                 }
            //                 for (i = 1; i < dateEnd + 1; ++i) {
            //                     var tdblanks2 = document.createElement('td');
            //                     tdblanks2.setAttribute('id', eles.availability.status + "~" + eles.nonpeak + "~" + eles.peak + "~" + seasondates + "~" + eles.blocking.block + "~" + eles.blocking.cancel + "~" + eles.pdays + "~" + eles.nonpdays);
            //                     tr3.append(tdblanks2);
            //                     // tr2.append(cutoffblanks);
            //                 }
            //             }
            //         });
            //     });
            //     if (monthend == month) {
            //         for (i = datestart; i < dateEnd + 1; ++i) {
            //             var th = document.createElement('td');
            //             var td = document.createTextNode(i);
            //             th.append(td);
            //             tr1.append(th);
            //         }
            //     } else {
            //         for (i = datestart; i < startmonth + 1; ++i) {
            //             var th = document.createElement('td');
            //             var td = document.createTextNode(i);
            //             th.append(td);
            //             tr1.append(th);
            //         }

            //         for (i = 1; i < dateEnd + 1; ++i) {
            //             var th = document.createElement('td');
            //             var td = document.createTextNode(i);
            //             th.append(td);
            //             tr1.append(th);
            //         }
            //     }
            // },
            // _selectMonth(m) {
            //     var nextmonthNames = ["January", "February", "March", "April", "May", "June",
            //         "July", "August", "September", "October", "November", "December"
            //     ];
            //     return nextmonthNames[m];
            // },
            _groupLoaded(data) {
                this.groupItems = data.detail.response.data;

            },
            toggleDrawer() {
                this.dispatchEvent(new CustomEvent('toggleDrawer', {
                    bubbles: true, composed: true, detail: {
                        narrow: this.$.narrow
                    }
                }));
                this.$.narrow = !this.$.narrow;
            },
        });
    </script>
</dom-module>